# =============================================================================
# Doctor Sample Unit (DSU) - Shared Runtime Requirements
# Platform: macOS Intel (x86_64) - CPU Only
# Python: 3.10
# =============================================================================
# Supports: BS-RoFormer, Audio-Separator, Demucs, Apollo
# Note: Intel Macs use CPU-only PyTorch (no GPU acceleration)
# =============================================================================

# -----------------------------------------------------------------------------
# PyTorch for Mac Intel
# Use 2.2.2 for maximum compatibility with Intel Macs
# (Newer versions may have issues with llvmlite/numba on Intel)
# Note: PyTorch 2.3+ is not available for Intel Mac
# -----------------------------------------------------------------------------
torch==2.2.2
torchaudio==2.2.2
torchvision==0.17.2

# -----------------------------------------------------------------------------
# NumPy - Use numpy<2 for torch 2.2.2 compatibility on Intel Mac
# (numpy>=2 may cause compatibility issues with torch 2.2.2)
# -----------------------------------------------------------------------------
numpy<2

# -----------------------------------------------------------------------------
# Audio Processing Core
# -----------------------------------------------------------------------------
# audio-separator: Will be installed separately with --no-deps due to torch version conflict
# Note: Recent versions require torch>=2.3, but PyTorch 2.3+ is not available for Intel Mac
# We'll install it separately after other dependencies to work around the version conflict
# audio-separator==0.41.0
librosa>=0.10.0
soundfile>=0.12.0
samplerate==0.1.0
pydub>=0.25.0
scipy>=1.10.0
resampy>=0.4.0
# asteroid: training-only (Bandit loss), lazy - not needed for inference
# Demucs (uses soundfile for audio I/O to avoid torchcodec dependency issues on Intel Mac)
# Pin to 4.0.0 to use wheel, avoid --only-binary resolution failure and building from source
demucs==4.0.0
# torchcodec>=0.5  # Optional - not available for Intel Mac, soundfile is used instead

# -----------------------------------------------------------------------------
# ONNX (CPU version) - REMOVED: Not used, causes performance overhead
# -----------------------------------------------------------------------------
# onnx>=1.14.0
# onnx2torch>=1.5.0
# onnxruntime>=1.16.0

# -----------------------------------------------------------------------------
# Model Dependencies
# -----------------------------------------------------------------------------
# asteroid, pedalboard, torch_audiomentations: training-only, lazy - not needed for inference
spafe                     # Required by Bandit (fbanks) - inference
einops>=0.7.0
julius>=0.2.7
diffq>=0.2.4              # Required for Demucs quantized models
beartype>=0.18.5,<0.19.0  # Required for BS-RoFormer
rotary-embedding-torch>=0.6.1,<0.7.0  # Required for BS-RoFormer

# -----------------------------------------------------------------------------
# Configuration & Utilities
# -----------------------------------------------------------------------------
requests>=2.28.0
tqdm>=4.65.0
six>=1.16.0
pyyaml>=6.0
omegaconf>=2.3.0
# huggingface-hub>=0.20.0  # REMOVED: Not needed - Apollo models load from local files, dummy module provided
# pytorch-lightning>=2.0.0  # REMOVED: Training only, not needed for inference
ml-collections>=0.1.0
matplotlib

# -----------------------------------------------------------------------------
# Build Tools (optional - for creating frozen binaries)
# -----------------------------------------------------------------------------
cx-Freeze==6.15.16
